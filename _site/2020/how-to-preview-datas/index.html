<blockquote>
  <p>机器学习」之数据预处理：hadoop,hive等输出数据导出为csv文件</p>
</blockquote>

<p>解决：用表格软件打开的数据文件，数据都保存在同一列；通过一些小技巧把一列的数据分成我们所需要的列数。</p>

<p>写论文的时候遇到的问题：
<code class="language-plaintext highlighter-rouge">problem</code>
hadoop1.0.3
使用hadoop对数据进行<code class="language-plaintext highlighter-rouge">map-reduce</code>操作后，在终端上呈现的形式：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span> <span class="mi">31</span>    <span class="mi">24</span>	<span class="mi">1</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span> <span class="mi">26</span>    <span class="mi">21</span>	<span class="mi">1</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span> <span class="mi">31</span>    <span class="mi">27</span>	<span class="mi">2</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span> <span class="mi">31</span>    <span class="mi">25</span>	<span class="mi">1</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span> <span class="mi">44</span>    <span class="mi">11</span>	<span class="mi">1</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.100</span> <span class="mi">42</span>    <span class="mi">8</span>	<span class="mi">1</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span> <span class="mi">27</span>    <span class="mi">55</span>	<span class="mi">1</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span> <span class="mi">26</span>    <span class="mi">25</span>	<span class="mi">2</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span> <span class="mi">21</span>    <span class="mi">26</span>	<span class="mi">2</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.100</span> <span class="mi">40</span>    <span class="mi">87</span>	<span class="mi">2</span>
</code></pre></div></div>
<p>这里的操作仅仅是对日志的长度进行了调整，最终目的是对日志进行聚类，所以对数据整合特征，整理出几个特征包括：
<code class="language-plaintext highlighter-rouge">ip，url长度，parameter长度和visit times per hours</code>这四个特征；</p>

<p>在实际的操作中，是不可能把hadoop的输出打印在终端上然后ctrl+c,ctrl+v，这样的工作量很大。
1.当然hadoop也给出了解决方案就是通过web交互页面访问文件，并有下载文件的按钮。
2.<code class="language-plaintext highlighter-rouge">hadoop fs -get</code>命令同样也可以把输出文件从hdfs文件系统下载到本地。
但是使用表格软件打开，所有的数据仍然是处在同一列下，且无法分列。所以导致并不能继续后面的python读取csv的操作，会报错；</p>

<p>解决方法：</p>

<p>数据分列操作：
网上有大把的教程提示我们如何去把一堆数据从一列中分离成数列。
wps和excel原理基本都不变：选中数据列，点选<code class="language-plaintext highlighter-rouge">数据</code>-<code class="language-plaintext highlighter-rouge">分列</code>则可进入分列操作，分列操作需要我们去告诉机器，哪些是数据需要分出来单独成一列，所以以下就是重点：分隔符；</p>

<p>我们需要对代码进行修改，即保证：我们所需要的每列输出的字段和后面的字段中间都存在分隔符，分隔符可以是<code class="language-plaintext highlighter-rouge">tab</code>，空格等等；
<code class="language-plaintext highlighter-rouge">map print</code>初始代码</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">print</span> <span class="nx">ip</span><span class="p">,</span><span class="nx">format</span><span class="p">(</span><span class="nx">len</span><span class="p">(</span><span class="nx">url</span><span class="p">)),</span><span class="nx">format</span><span class="p">(</span><span class="nx">len</span><span class="p">(</span><span class="nx">para</span><span class="p">))</span>
</code></pre></div></div>
<p>修改后代码，如下，在第二列和第三列输出之间加入了两个空格，告诉python <code class="language-plaintext highlighter-rouge">print (' ')</code></p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">print</span> <span class="nx">ip</span><span class="p">,</span><span class="nx">format</span><span class="p">(</span><span class="nx">len</span><span class="p">(</span><span class="nx">url</span><span class="p">)),(</span><span class="dl">'</span><span class="s1">  </span><span class="dl">'</span><span class="p">),</span><span class="nx">format</span><span class="p">(</span><span class="nx">len</span><span class="p">(</span><span class="nx">para</span><span class="p">))</span>
</code></pre></div></div>

<p>于是在把输出文件导出后，使用表格软件打开文件同样是所有的数据存在同一列的情况，这个时候我们对数据列进行数据分列操作后即可分出我们所需要的列数，我这个是四列。如下，我们在终端下cat一下：</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">ip</span><span class="p">,</span><span class="nx">url</span><span class="p">,</span><span class="nx">para</span><span class="p">,</span><span class="nx">time</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">303</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">1</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">1</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">2</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">333</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">1</span>
<span class="mf">127.0</span><span class="p">.</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">2</span>
<span class="mf">192.168</span><span class="p">.</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">1</span>
</code></pre></div></div>
<p>（表头自己加即可）
我们可以看到，数据显示，每列的数据中间都有一个逗号。当然，我们在输出的时候，也可以对数据进行处理，每一列数据都加上逗号，理论上是可行的，我没有试过。鼓励各位多动手。</p>
